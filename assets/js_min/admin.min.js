function searchTest(a){jQuery.ajax({type:"GET",url:ajaxurl,data:{action:"search_tests",value:encodeURIComponent(a)},success:function(a){var b=jQuery.parseJSON(a);jQuery("#test_suggestions").html(""),jQuery("#test_suggestions").fadeIn(),jQuery.each(b,function(a,b){jQuery("#test_suggestions").append('<li><a href="javascript:addTest('+b.ID+", '"+b.post_title+"');\">"+b.post_title+"</a></li>")})}})}function addTest(a,b){var c=jQuery("#test_to_group").html(),d=c.replace(/{test_id}/g,a).replace(/{test_name}/g,b);jQuery("#selected_tests tbody").append(d),jQuery("#test_suggestions").fadeOut()}function removeTest(a){jQuery("#group_id").val()>0?jQuery.ajax({type:"GET",url:ajaxurl,data:{action:"remove_test",value:encodeURIComponent(a),group:encodeURIComponent(jQuery("#group_id").val())},success:function(b){var c=jQuery.parseJSON(b);"success"==c.result?jQuery("#selected_tests tbody").find("#tests-"+a).remove():alert("Error: Can't remove this Test!!!")}}):jQuery("#selected_tests tbody").find("#tests-"+a).remove()}function searchUser(a){jQuery.ajax({type:"GET",url:ajaxurl,data:{action:"search_users",value:encodeURIComponent(a)},success:function(a){var b=jQuery.parseJSON(a);jQuery("#user_suggestions").html(""),jQuery("#user_suggestions").fadeIn(),jQuery.each(b,function(a,b){jQuery("#user_suggestions").append('<li><a href="javascript:addUser('+b.ID+", '"+b.user_login+"');\">"+b.user_login+"</a></li>")})}})}function addUser(a,b){var c=jQuery("#user_to_group").html(),d=c.replace(/{user_id}/g,a).replace(/{username}/g,b);jQuery("#selected_users tbody").append(d),jQuery("#user_suggestions").fadeOut()}function removeUser(a){jQuery("#group_id").val()>0?jQuery.ajax({type:"GET",url:ajaxurl,data:{action:"remove_user",value:encodeURIComponent(a),group:encodeURIComponent(jQuery("#group_id").val())},success:function(b){var c=jQuery.parseJSON(b);"success"==c.result?jQuery("#selected_users tbody").find("#users-"+a).remove():alert("This User is owner this Group!!!")}}):jQuery("#selected_users tbody").find("#users-"+a).remove()}function searchCourses(a){jQuery.ajax({type:"GET",url:ajaxurl,data:{action:"search_courses",value:encodeURIComponent(a)},success:function(a){var b=jQuery.parseJSON(a);jQuery("#courses_suggestions").html(""),jQuery("#courses_suggestions").fadeIn(),jQuery.each(b,function(a,b){jQuery("#courses_suggestions").append('<li><a href="javascript:addCourse('+b.ID+", '"+b.post_title+"');\">"+b.post_title+"</a></li>")})}})}function addCourse(a,b){var c=jQuery("#course_to_group").html(),d=c.replace(/{courseid}/g,a).replace(/{course-name}/g,b);jQuery("#selected_courses tbody").append(d),jQuery("#courses_suggestions").fadeOut()}function removeCourse(a){jQuery("#group_id").val()>0?jQuery.ajax({type:"GET",url:ajaxurl,data:{action:"remove_courses",value:encodeURIComponent(a),group:encodeURIComponent(jQuery("#group_id").val())},success:function(b){var c=jQuery.parseJSON(b);"success"==c.result?jQuery("#selected_courses tbody").find("#courses-"+a).remove():alert("Error: Can't remove this course!!!")}}):jQuery("#selected_courses tbody").find("#courses-"+a).remove()}function removeGroup(a){jQuery.ajax({type:"GET",url:ajaxurl,data:{action:"remove_group",value:encodeURIComponent(a)},success:function(b){jQuery("#group-"+a).addClass("removed"),jQuery("#delete-"+a).attr("href",'javascript: deleteGroup("'+a+'")'),jQuery("#restore-"+a).attr("style","display: inline")}})}function deleteGroup(a){jQuery.ajax({type:"GET",url:ajaxurl,data:{action:"delete_group",value:encodeURIComponent(a)},success:function(b){jQuery("#group-"+a).remove()}})}function restoreGroup(a){jQuery.ajax({type:"GET",url:ajaxurl,data:{action:"restore_group",value:encodeURIComponent(a)},success:function(b){jQuery("#group-"+a).removeClass("removed"),jQuery("#delete-"+a).attr("href",'javascript:removeGroup("'+a+'")'),jQuery("#restore-"+a).attr("style","display: none")}})}function addGroup(a,b){var c=jQuery("#group_add").html(),d=c.replace(/{group_id}/g,a).replace(/{groupname}/g,b);jQuery("#selected_groups tbody").append(d),jQuery("#group_suggestions").fadeOut()}function delGroup(a){jQuery("#selected_groups tbody").find("#groups-"+a).remove()}!function(a){a(document).ready(function(){var b={toggleStep:function(){a(".step_numb i.hide").live("click",function(b){b.preventDefault();var c=a(this).data("step");a(".step-"+c).hide("slow"),a(this).removeClass("hide").addClass("show")}),a(".step_numb i.show").live("click",function(b){b.preventDefault();var c=a(this).data("step");a(".step-"+c).show("slow"),a(this).removeClass("show").addClass("hide")}),a(".questContent i.hide").live("click",function(b){a(this).parent().next().hide("slow"),a(this).removeClass("hide").addClass("show"),b.preventDefault()}),a(".questContent i.show").live("click",function(b){a(this).parent().next().show("slow"),a(this).removeClass("show").addClass("hide"),b.preventDefault()}),a(".video_part_title i.hide").live("click",function(b){a(this).parent().next().hide("slow"),a(this).removeClass("hide").addClass("show"),b.preventDefault()}),a(".video_part_title i.show").live("click",function(b){a(this).parent().next().show("slow"),a(this).removeClass("show").addClass("hide"),b.preventDefault()})},addStep:function(){a(".addStep").live("click",function(b){b.preventDefault();var c=parseInt(a(this).data("step")),d=c+1,e=a("#interaction_step_tpl").html(),f=e.replace(/{step}/g,d);a(".course_steps").append(f),a(".editor_wrap_step_"+d).wp_editor(),a(this).parent().remove()})},addVideoStep:function(){a(".AddStepVideo").live("click",function(b){b.preventDefault();var c=parseInt(a(this).data("step")),d=parseInt(a(this).data("video")),e=d+1,f=a("#interaction_video_step").html(),g=f.replace(/{video}/g,e).replace(/{step}/g,c);a(".video_data_wrapper_"+c).append(g),a(".video_descr_"+c+"_"+e).wp_editor(),a(this).parent().remove()})},addQuest:function(){var b="";a(".add_q").live("click",function(c){c.preventDefault(),a(this).hasClass("AddQuest")?b=a("#true_false_quest").html():a(this).hasClass("AddMultiple")?b=a("#multiple_quest").html():a(this).hasClass("AddImageQuest")&&(b=a("#image_quest").html());var d=parseInt(a(this).data("step")),e=parseInt(a(this).data("questnum")),f=e+1,g=b.replace(/{step}/g,d).replace(/{q_num}/g,f).replace(/{a_num}/g,1);a(".questContent-"+d).append(g),a(this).parent().find("a").data("questnum",f).attr("data-questnum",f),a("#step-"+d+"-quest-"+f).wp_editor()})},deleteVideo:function(){a(".video_part_title i.delete").live("click",function(b){b.preventDefault(),a(this).parent().next().remove(),a(this).parent().remove()})},deleteQuest:function(){a(".questContent i.delete").live("click",function(b){b.preventDefault(),a(this).parent().parent().remove()})},addAnswers:function(){a(".addAnswer").live("click",function(b){b.preventDefault();var c=parseInt(a(this).data("step")),d=parseInt(a(this).data("questnum")),e=parseInt(a(this).data("answer")),f=e+1,g=a("#multiple_answer").html(),h=g.replace(/{step}/g,c).replace(/{q_num}/g,d).replace(/{a_num}/g,f);a(".step-"+c+"-quest-"+d+"-answers").append(h),a(this).data("answer",f).attr("data-answer",f)}),a(".addAnswerImg").live("click",function(b){var c=parseInt(a(this).data("step")),d=parseInt(a(this).data("questnum")),e=parseInt(a(this).data("answer")),f=e+1,g=a("#image_quest_answer").html(),h=g.replace(/{step}/g,c).replace(/{q_num}/g,d).replace(/{a_num}/g,f);a(".step-"+c+"-quest-"+d+"-answers").append(h),a(this).data("answer",f).attr("data-answer",f)})},delAnswer:function(){a(".delAnswer").live("click",function(b){b.preventDefault(),a(this).parent().remove()})},selectTrue:function(){a(".select_true").live("click",function(){a(this).parent().parent().find(".answer_hidden").attr("value","false"),a(this).parent().find(".answer_hidden").attr("value","true"),a(this).parent().parent().find(".select_true").removeAttr("checked"),a(this).attr("checked",!0)})},initSteps:function(){a(".enable_disable .butt").live("click",function(){a(".enable_disable .butt").removeClass("active"),a(this).addClass("active"),a(this).hasClass("on")?(a(".init_interaction input").attr("checked",!0),a(".step_title").find("input").attr("required",!0)):(a(".init_interaction input").removeAttr("checked"),a(".step_title").find("input").removeAttr("required"))})},deleteStep:function(){a(".step_numb .delete").live("click",function(){a(this).parent().parent().remove()})},init:function(){b.toggleStep(),b.addStep(),b.addVideoStep(),b.addQuest(),b.deleteQuest(),b.deleteVideo(),b.addAnswers(),b.delAnswer(),b.selectTrue(),b.initSteps(),b.deleteStep()}};b.init()})}(jQuery),function(a){a(document).ready(function(){var b={createPostMatrix:function(){alert(JSON.stringify(a(".question-space").serialize()))},add_rem_quests:function(){a(function(){a(".add-question").live("click",function(){var b=parseInt(a(".question:last-child").attr("rel-id"))+1,c=a("#question-template").clone().attr("id","").css("display","block").appendTo(".question-space");return c.attr("rel-id",b),c.find("input.question-answer-radio").attr("name","answers["+b+"]").val("0"),c.find("input.question-answer").attr("name","questions["+b+"][0]"),c.find("input.question-title").attr("name","titles["+b+"]"),!1}),a(".remove-question").live("click",function(){return a(this).parent().remove(),!1}),a(".repeatable-add").live("click",function(){var b=a(this).parent().find("ul li:last-child").attr("rel-id");counter=Number(b)+1;var c=a(this).parent().find("ul li.original").clone().removeClass("original").appendTo(a(this).parent().find("ul"));return c.attr("rel-id",counter),c.find("input.question-answer-radio").attr("name","answers["+a(this).parent().attr("rel-id")+"]").val(counter),c.find("input.question-answer").val("").attr("name","questions["+a(this).parent().attr("rel-id")+"]["+counter+"]"),!1}),a(".repeatable-remove").live("click",function(){return a(this).parent().remove(),!1})})},videoAdd:function(){a(".add-attach-video").live("click",function(b){b.preventDefault();var c=parseInt(a(".add-attach-video").data("num")),d=c+1;a(this).remove();var e=a("#attach_video_add_tpl").html(),f=e.replace(/{numb}/g,c).replace(/{next}/g,d);a(".video_inputs").append(f)})},videoTypeChange:function(){a(".select_type_video div").live("click",function(b){b.preventDefault();var c=a(this).data("type");"url"==c?(a(this).parent().next().find(".lms_attach_video").attr("type","url"),a(this).addClass("active"),a(this).parent().find("div.file").removeClass("active")):(a(this).parent().next().find(".lms_attach_video").attr("type","file"),a(this).addClass("active"),a(this).parent().find("div.url").removeClass("active"))})},mediaFieldAdd:function(){a(".add-attach-media").live("click",function(b){b.preventDefault();var c=parseInt(a(".add-attach-media").data("num")),d=c+1;a(this).remove();var e=a("#attach_media_add_tpl").html(),f=e.replace(/{numb}/g,c).replace(/{next}/g,d);a("#media_section").append(f)})},certificateField:function(){a(".upload_image_button").click(function(){var b=wp.media.editor.send.attachment,c=a(this);return wp.media.editor.send.attachment=function(d,e){a(c).parent().prev().attr("src",e.url),a(c).prev().val(e.id),wp.media.editor.send.attachment=b,a("#img_thumb").show()},wp.media.editor.open(c),!1}),a(".remove_image_button").click(function(){var b=confirm("Delete this image?");if(1==b){var c=a(this).parent().prev().attr("data-src");a(this).parent().prev().attr("src",c),a(this).prev().prev().val(""),a("#img_thumb").hide()}return!1})},thumbnail:function(){a(".upload_thumbnail_button").click(function(){var b=wp.media.editor.send.attachment,c=a(this);return wp.media.editor.send.attachment=function(d,e){a(c).parent().prev().attr("src",e.url),a(c).prev().val(e.id),wp.media.editor.send.attachment=b,a("#image_thumb").show()},wp.media.editor.open(c),!1}),a(".remove_thumbnail_button").click(function(){var b=confirm("Delete this image?");if(1==b){var c=a(this).parent().prev().attr("data-src");a(this).parent().prev().attr("src",c),a(this).prev().prev().val(""),a("#image_thumb").hide()}return!1})},deleteVideo:function(){a(".delete-attach-video").click(function(b){b.preventDefault();var c=a(this).data("del");a("#video-"+c).remove();var d=a("#wp_custom_attachment .attach").find(".video_space");if(0==d.length){var e=a("#attach_video_new_tpl").html(),f=e.replace(/{numb}/g,0).replace(/{next}/g,1);a(".video_inputs .attach hr").before(f),a(".add-attach-video").attr("data-num","1")}})},deleteMedia:function(){a(".delete-attach-media").click(function(b){b.preventDefault();var c=a(this).data("del");a("#attached-"+c).remove();var d=a("#media_section").find(".lms_attach_media_files_contain");if(0==d.length){var e=a("#attach_media_new_tpl").html(),f=e.replace(/{numb}/g,0).replace(/{next}/g,1);a("#media_section hr").before(f),a(".add-attach-media").attr("data-num","1")}})},init:function(){b.add_rem_quests(),b.videoAdd(),b.videoTypeChange(),b.mediaFieldAdd(),b.certificateField(),b.thumbnail(),b.deleteVideo(),b.deleteMedia()}};b.init()})}(jQuery),jQuery(document).ready(function(a){jQuery(document).click(function(){jQuery("#test_suggestions").fadeOut(),jQuery("#user_suggestions").fadeOut(),jQuery("#courses_suggestions").fadeOut(),jQuery("#group_suggestions").fadeOut()}),jQuery(".copy_group").live("click",function(b){b.preventDefault();var c=a(this).data("id");a.ajax({type:"GET",url:ajaxurl,data:{action:"copy_group",value:encodeURIComponent(c)},success:function(a){var b=jQuery.parseJSON(a);"success"==b.result?alert("Copied!!!"):alert("Error: Can't copy this group!!!")}})}),a(".view_group_reports").live("click",function(b){b.preventDefault();var c=[a(this).data("id")];a("#report_modal").dialog({autoOpen:!1,modal:!0,dialogClass:"fixed-dialog",show:{effect:"blind",duration:1e3},hide:{effect:"explode",duration:1e3}}),a("#report_modal").dialog("open"),a.ajax({type:"POST",url:ajaxurl,data:{action:"get_reports_group_report",data_value:c,attempts:"false",hits:"false",day_from:"0001-01-01",day_to:"9999-01-01"},success:function(b){a("#results_table").html("");var c=a("#results_template").html(),d=a.parseJSON(b);d&&a.each(d,function(b,d){a.each(d,function(b,d){var e=c.replace(/{num}/g,d.num?d.num:"-").replace(/{first_name}/g,d.first_name?d.first_name:"-").replace(/{last_name}/g,d.last_name?d.last_name:"").replace(/{post_title}/g,d.post_title?d.post_title:"no-name").replace(/{score}/g,d.score?d.score:"-").replace(/{symbol}/g,d.symbol?d.symbol:"-").replace(/{time}/g,d.time?d.time:"-").replace(/{date_hits}/g,d.date_hits?d.date_hits:d.time).replace(/{attempts}/g,d.attempts?d.attempts:"0").replace(/{attempts_limit}/g,d.attempts_limit?d.attempts_limit:"0").replace(/{hits}/g,d.hits?d.hits:d.attempts).replace(/{hits_limit}/g,d.hits_limit?d.hits_limit:"0").replace(/{lms_interaction_date}/g,d.lms_interaction_date?d.lms_interaction_date:"-").replace(/{due}/g,d.due?d.due:"-");a("#results_table").append(e)})})}})})}),function(a){a(document).ready(function(){var b={changeReportType:function(){a(".selector_item").on("click",function(){var b=a(this).data("type");a(".selector_item").removeClass("active"),a(this).addClass("active"),a(".report-type").removeClass("active"),a("#"+b).addClass("active"),a("#current_report").attr("value",b)})},searchGroupReports:function(){a("#groups_search").on("keyup",function(){var b=a("#groups_search").val();a.ajax({type:"GET",url:ajaxurl,data:{action:"search_groups_report",value:encodeURIComponent(b)},success:function(b){if(null!=b){var c=a.parseJSON(b);null!=c&&(a("#group_suggestions").html(""),a("#group_suggestions").fadeIn(),a.each(c,function(b,c){a("#group_suggestions").append('<li><a href="javascript:addGroup('+c.group_id+", '"+c.name+"');\">"+c.name+"</a></li>")}))}}})})},searchTestReports:function(){a("#tests_search").on("keyup",function(){var b=a("#tests_search").val();a.ajax({type:"GET",url:ajaxurl,data:{action:"search_tests_report",value:encodeURIComponent(b)},success:function(b){if(null!=b){var c=a.parseJSON(b);null!=c&&(a("#test_suggestions").html(""),a("#test_suggestions").fadeIn(),a.each(c,function(b,c){a("#test_suggestions").append('<li><a href="javascript:addTest('+c.ID+", '"+c.post_title+"');\">"+c.post_title+"</a></li>")}))}}})})},searchUserReports:function(){a("#users_search").on("keyup",function(){var b=a("#users_search").val();a.ajax({type:"GET",url:ajaxurl,data:{action:"search_users_report",value:encodeURIComponent(b)},success:function(b){if(null!=b){var c=a.parseJSON(b);null!=c&&(a("#user_suggestions").html(""),a("#user_suggestions").fadeIn(),a.each(c,function(b,c){a("#user_suggestions").append('<li><a href="javascript:addUser('+c.ID+", '"+c.user_login+"');\">"+c.user_login+"</a></li>")}))}}})})},getReports:function(){a("#generate_reports").on("click",function(){var b=[],c="",d=a("#current_report").val();if(a("#attempts").prop("checked"))var e="true";else var e="false";if(a("#hits").prop("checked"))var f="true";else var f="false";var g=a("#day_from").val(),h=a("#day_to").val();switch(""==g&&(g="0001-01-01"),""==h&&(h="9999-01-01"),d){case"group_report":c=a("#selected_groups tbody").find("tr");break;case"user_report":c=a("#selected_users tbody").find("tr");break;case"test_report":c=a("#selected_tests tbody").find("tr");break;default:return}c.length>0&&a.each(c,function(a,d){b.push(c.eq(a).data("id"))}),a.ajax({type:"POST",url:ajaxurl,data:{action:"get_reports_"+d,data_value:b,attempts:e,hits:f,day_from:g,day_to:h},success:function(b){a("#results_table").html("");var c=a("#results_template").html(),d=a.parseJSON(b);d&&a.each(d,function(b,d){a.each(d,function(b,d){var e=c.replace(/{num}/g,d.num?d.num:"-").replace(/{first_name}/g,d.first_name?d.first_name:"-").replace(/{last_name}/g,d.last_name?d.last_name:"").replace(/{post_title}/g,d.post_title?d.post_title:"no-name").replace(/{score}/g,d.score?d.score:"-").replace(/{symbol}/g,d.symbol?d.symbol:"-").replace(/{time}/g,d.time?d.time:"-").replace(/{date_hits}/g,d.date_hits?d.date_hits:d.time).replace(/{attempts}/g,d.attempts?d.attempts:"0").replace(/{attempts_limit}/g,d.attempts_limit?d.attempts_limit:"0").replace(/{hits}/g,d.hits?d.hits:d.attempts).replace(/{hits_limit}/g,d.hits_limit?d.hits_limit:"0").replace(/{lms_interaction_date}/g,d.lms_interaction_date?d.lms_interaction_date:"-").replace(/{due}/g,d.due?d.due:"-");a("#results_table").append(e)})})}})})},init:function(){b.changeReportType(),b.searchGroupReports(),b.searchTestReports(),b.searchUserReports(),b.getReports()}};b.init()})}(jQuery);